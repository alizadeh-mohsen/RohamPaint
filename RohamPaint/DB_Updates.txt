

CREATE TABLE [dbo].[ColorFormul](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ColorID] [int] NOT NULL,
	BaseColor nvarchar(50) NOT NULL,
	[Weight] [real] NOT NULL,
 CONSTRAINT [PK_ColorFormul] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[ColorFormul]  WITH CHECK ADD  CONSTRAINT [FK_ColorFormul_Color] FOREIGN KEY([ColorID])
REFERENCES [dbo].[Color] ([ID])
ON DELETE CASCADE

GO

ALTER TABLE [dbo].[ColorFormul] CHECK CONSTRAINT [FK_ColorFormul_Color]

GO


INSERT INTO [dbo].[ColorFormul]
           ([ColorID]
           ,[BaseColor]
           ,[Weight])
     select 
           ColorID,
           (select code from BaseColor b where f.BaseId=b.ID),
           Weight
		   from formul f


Go
ALTER TABLE Car ADD [Name] NVARCHAR(50) NULL;

Go

UPDATE Car SET [Name] = [Car];
